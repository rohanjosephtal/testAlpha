#circle.yml

machine:
  services:
    - docker

dependencies:
  override:
    - docker info
    - cat /etc/default/docker
    - sudo echo OPTIONS="--insecure-registry"=$DockerRepo >> /etc/default/docker
    - sed -i '15i RUN echo "[default]" >> ~/.aws/credentials'  Dockerfile 
    - sed -i '16i RUN echo AWS_ACCESS_KEY_ID'=$AWS_ACCESS_KEY_ID' >> ~/.aws/credentials'  Dockerfile 
    - sed -i '17i RUN echo AWS_SECRET_ACCESS_KEY'=$AWS_SECRET_ACCESS_KEY' >> ~/.aws/credentials'  Dockerfile
    - cat Dockerfile
    - docker build -t $DockerRepo/twiin-app-dev-accounts-v-000 .
    - docker push $DockerRepo/twiin-app-dev-accounts-v-000